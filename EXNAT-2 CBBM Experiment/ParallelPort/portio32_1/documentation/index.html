<html>
<head>
   <title>Documentation for PortIO32</title>
</head>
<body text="#000000" bgcolor="#FFFFFF" link="#0000EE" vlink="#551A8B">

<center><h2>Documentation for PortIO32</h2></center>
<hr>
<h3>Overview</h3>
<p>PortIO32 is a driver and library which allows you to do low-level port IO from
any programming language which can use a DLL in Windows or can link with
a C library in Linux. This includes C/C++, Visual Basic, and others. Being
able to use low-level port I/O allows you to manually program Winford Engineering's
I/O cards. Although it is more difficult to use than Winford Engineering's
<I>Portal</I> API, it can sometimes be advantageous to directly manipulate the
hardware. This documentation does not cover the details of individual cards
and how to program them. It only covers how to use the PortIO32 library.
To find out more about directly programming your I/O card, see your user's
manual (Manuals are also available on Winford Engineering's website. Visit
<a href="http://www.winfordeng.com/">http://www.winfordeng.com</a>).
</p>
<p>
<h4>Getting Started</h4>
The basic steps to getting started are:
<ol>
 <li><a href="#install">Install the driver and library on your system.</a>  This only needs 
     to be done once.
 <li><a href="#languages">Learn how to use PortIO32 in the applications you write.</a>  You 
     may find the <a href="#samples">sample applications</a> useful as a guide in writing 
     your own applications.
 <li>Write your applications.  See the <a href="#functions">function reference</a> for 
     a list of the functions provided by PortIO32.
 <li>Compile and run your applications!
</ol>


<h4>Systems Supported</h4>
PortIO32 is designed to work with the following operating systems:
<ul>
 <li>Windows XP
 <li>Windows 2000
 <li>Windows Me
 <li>Windows 98
 <li>Windows 95
 <li>Windows NT
 <li>Linux 2.0 and above
</ul>

<a name="functions">
<h3><b><u>Function Reference:</u></b></h3>

<p><i>int OutByte (unsigned
short <b>Port</b>, int <b>Data</b>);</i>
<br>OutByte writes a value to a single I/O port. Pass OutByte the <b>Port</b>
you want to write to and the <b>Data</b> value you want to write. Since I/O ports
are 8-bit, this function can only write 8 bits of information to the port.
If <b>Data</b> is too large to be expressed with 8 bits, the lower eight
bits are written to the port. This function returns a 0 for success, or
a -1 if an error occurred.

<p><i>int OutWord (unsigned
short <b>Port</b>, int <b>Data</b>);</i>
<br>OutWord is like OutByte except that 16 bits of data are written to
two consecutive ports instead of 8 bits to a single port. The lower 8 bits
are written to <b>Data</b> and the upper eight bits are written to <b>Data</b>
+ 1.

<p><i>int InByte (unsigned
short <b>Port</b>, int * <b>Data</b>);</i>
<br>InByte reads a value from a single I/O port. You must pass InByte the
<b>Port</b>
you want to read from and a pointer to a variable that you have declared.
When the function is finished, your variable will contain the value that
was read from the port. The value is returned in this way so that the return
value of the function can indicate whether or not the operation succeeded.
The function returns a value of 0 when it succeeds, and -1 when it fails.

<p><i>int InWord (unsigned
short <b>Port</b>, int * <b>Data</b>);</i>
<br>InWord is similar to InByte except that 16 bits of data are read from
two consecutive ports instead of 8 bits from a single port. The lower 8
bits are read from <b>Data</b> and the upper eight bits are read from
<b>Data</b> + 1.

<p><i>int InByteR (unsigned
short <b>Port</b>);</i>
<br>InByteR is like InByte in that it reads a value from a single port.
This function is provided for those who have difficulty dealing with pointers
to variables (the method that is used for InByte). Instead of giving you
the value through a pointer, this function returns the value that was read.
The only disadvantage is that you do not get an indication if the function
failed or succeeded with this method. The function will return 0 if it
was unable to read from the port, but since 0 is a valid value that could
have been successfully read from the port, you never know if the function
failed.

<p><i>int InWordR (unsigned
short <b>Port</b>);</i>
<br>InWordR is like InWord in that it reads 16 bits of data from two consecutive
ports. The difference is that it gives you the value it reads through its
return value instead of a pointer (See InByteR above for details).

<a name="languages">
<h3><b><u>Programming Languages:</u></b></h3>
<h4>Declarations</h4>
There are a few special steps that must be taken to use PortIO32 from a
programming language. First of all, you must include a file in your project
which gives you the declarations for the functions. In C/C++, this is the
portio32.h file. In Visual Basic 5 and 6 it is PortIO32.bas, and in Visual 
Basic .NET it is PortIO32.vb.

<h4>Linking with Library Files</h4>
<p>On Linux, you must link your program with the portio32.a library 
file.  It is probably easiest to copy portio32.a
into the directory of your source code. Here is an example of compiling 
a program:
<br>gcc myfile.c portio32.a
<br>The portio32.a file is a static library. This means that after you
have compiled your program, your program is not dependent on the library
file.

<p>On Windows, compiling
procedures vary depending on what compiler you are using. You must instruct
your compiler to link with the PortIO32.lib file that is provided with
the Windows version.  In Microsoft Visual Studio C++, this is done by adding 
PortIO32.lib to the list of libraries in the Link section of the Project Settings 
/ Project Properties.  For example, in Visual Studio .NET, open the Project 
Properties and navigate to Configuration Properties -> Linker -> Input, 
and enter "PortIO32.lib" in the "Additional Dependencies" box.

<p>
If you are using a Borland C/C++ compiler, you will need to link your 
project with the bPortIO32.lib file instead.  As a general tip for Borland 
users, Microsoft format (COFF) .lib files can be converted to Borland's 
format (OMF) using Borland's COFF2OMF utility, for example:
<p>
<pre>
COFF2OMF -lib:st PortIO32.lib bPortIO32.lib
</pre>

<p>
If ever necessary, a Borland format .lib file can be created directly 
from a DLL, for example:
<p>
<pre>
implib bPortIO32.lib PortIO32.dll
</pre>

<p>
In Visual Basic, no special compiling/linking steps are necessary.  You must simply 
include the appropriate module (as described above) in your project.

<a name="install">
<h3><b><u>Installation:</u></b></h3>
The installation for PortIO32 is very simple, but it is different depending
on the operating system you use.
<h3>Windows</h3>
<p>
The driver/library installation procedure is very similar on all versions
of Windows except Windows NT (see below).   The driver is installed
using the "Add Hardware" option of the Control Panel.  Since there is 
no hardware that will be detected automatically by Windows, the PortIO32 
driver will need to be installed by manually selecting a driver, using 
the "Have Disk" button to point Windows to the "win\driver" directory.
More detailed instructions are available below:

<h4>Windows XP</h4>
<ol>
<li>Open the Control Panel.

<li>Open the "Add Hardware" wizard.  If you are using Windows XP's default "Category 
   View" for the Control Panel, this is done by clicking on "Printers and
   Other Hardware" and under "See Also" on the left, click "Add Hardware".

<li>The wizard typically displays a screen explaining what it is used for.  
   Click Next to continue.

<li>The wizard may automatically scan for new hardware.  The scanning 
   will not detect anything related to PortIO32.

<li>You may be asked "Have you already connected this hardware to your computer?"  
   Regardless of whether you have installed any cards yet, click Yes.

<li>You will be shown a list of the hardware already installed in your computer.
   Scroll all the way down and select "Add a new hardware device"

<li>You will be asked whether Windows should search for the new hardware.  Select
   "Install the hardware that I manually select from a list"

<li>A list of hardware categories will be shown.  Select "Show All Devices"
   (On some versions of Windows this may be called "Other")

<li>Click the "Have Disk" button and point Windows to the "win\driver"
   directory of the PortIO32 distribution.

<li>A list of drivers found in the directory you specified will be shown.  Select
    the "PortIO32 Port I/O Driver" item and click Next.

<li>Click Next again to "start installing your new hardware."

<li>The files will be copied and installed.  Click Finish to complete.  You do not 
    need to restart your computer.
</ol>

<h4>Windows 2000</h4>
<ol>
<li>Open the Control Panel

<li>Open the "Add/Remove Hardware" wizard

<li>The wizard typically displays a screen explaining what it is used for.  
   Click Next to continue.

<li>You will be asked whether to Add or Uninstall a device.  Select 
   "Add/Troubleshoot a device" and click Next.

<li>The wizard may automatically scan for new hardware.  The scanning 
   will not detect anything related to PortIO32.

<li>You will be shown a list of the hardware already installed in your computer.
   Select "Add a new device"

<li>You will be asked whether Windows should search for the new hardware.  Select
   "No, I want to select the hardware from a list"

<li>A list of hardware categories will be shown.  Select "Other devices"

<li>Click the "Have Disk" button and point Windows to the "win\driver"
   directory of the PortIO32 distribution.

<li>A list of drivers found in the directory you specified will be shown.  Select
    the "PortIO32 Port I/O Driver" item and click Next.

<li>You will be informed that "Windows will use default settings to install the 
    software for this hardware device."  Simply click Next to begin installation.

<li>The files will be copied and installed.  Click Finish to complete.  You do not 
    need to restart your computer.
</ol>

<h4>Windows NT</h4>
<ol>
<li>Run the NTinstall.exe program, located in the "win\driver" directory

<li>A message box will be shown explaining that the driver will be installed.  
   Click Yes to continue.

<li>A message box will be shown confirming that the driver was installed.  Click
   OK to complete.  You do not need to restart your computer.
</ol>

<h4>Windows Me</h4>
<ol>
<li>Open the Control Panel.

<li>Open the "Add New Hardware" wizard.  (You may have to click  
   "view all Control Panel options" for this to be displayed.)

<li>The wizard typically displays a screen explaining what it is used for.  
   Click Next to continue.

<li>You will be told that the wizard will scan for new Plug and Play 
   devices.  Click Next to continue.  The scan will not find anything
   related to PortIO32.  If the wizard displays a list of devices that
   were found, select "No, the device isn't in the list".

<li>You will be asked if Windows should search for non Plug and Play hardware.
   Select "No, I want to select the hardware from a list".

<li>A list of hardware categories will be shown.  Select "Other devices"

<li>Click the "Have Disk" button and point Windows to the "win\driver"
   directory of the PortIO32 distribution.

<li>A list of drivers found in the directory you specified will be shown.  Select
   the "PortIO32 Port I/O Driver" item and click Next.

<li>One last page will be shown stating "Windows can continue installing your
   hardware now."  Simply click Finish to perform the installation.
   You do not need to restart your computer.
</ol>


<h4>Windows 98</h4>
<ol>
<li>Open the Control Panel.

<li>Open the "Add New Hardware" wizard.

<li>The wizard typically displays a screen explaining what it is used for.  
   Click Next to continue.

<li>You will be told that the wizard will scan for new Plug and Play 
   devices.  Click Next to continue.  The scan will not find anything
   related to PortIO32.  If the wizard displays a list of devices that
   were found, select "No, the device isn't in the list".

<li>You will be asked if Windows should search for non Plug and Play hardware.
   Select "No, I want to select the hardware from a list".

<li>A list of hardware categories will be shown.  Select "Other devices"

<li>Click the "Have Disk" button and point Windows to the "win\driver"
   directory of the PortIO32 distribution.

<li>A list of drivers found in the directory you specified will be shown.  Select
   the "PortIO32 Port I/O Driver" item and click Next.

<li>One last page will be shown stating "Windows can continue installing your
   hardware now."  Simply click Finish to perform the installation.
   You do not need to restart your computer.
</ol>

<h4>Windows 95</h4>
<ol>
<li>Open the Control Panel

<li>Open the "Add New Hardware" wizard

<li>The wizard typically displays a screen explaining what it is used for.  
   Click Next to continue.

<li>You will be asked if Windows should search for your new hardware.
   Select "No".

<li>A list of hardware categories will be shown.  Select "Other devices"

<li>Click the "Have Disk" button and point Windows to the "win\driver"
   directory of the PortIO32 distribution.

<li>A list of drivers found in the directory you specified will be shown.  Select
   the "PortIO32 Port I/O Driver" item and click Next.

<li>One last page will be shown stating "Windows can continue installing your
   hardware now."  Simply click Finish to perform the installation.
   You do not need to restart your computer.
</ol>

<h4>Removal</h4>
On all Windows operating systems except Windows NT, the driver is displayed in the 
system Device Manager / Device Tree (along with your Serial Ports, Sound Cards, etc.).
The driver will be shown under the category of "Winford Engineering I/O Devices".
The driver can be uninstalled right from the device tree, typically by selecting 
the driver and hitting the 
Delete key or by right-clicking and selecting Uninstall.  On Windows NT, use the
NTuninstall.exe program in the "win\driver" directory to uninstall the driver service.

<h3>Linux</h3>
<p>The linux version of PortIO32 uses the device file /dev/port to perform
port I/O.  Therefore, no driver installation is necessary.  The only thing 
you must do is ensure that your applications are 
executed with root-level privileges.  This is due to the fact that port I/O 
is a privileged operation and is not available to non-root users.  Other than 
that, just be sure to link your program with portio32.a as described in the 
instructions above.
<p>

<h3><b><u>Download:</u></b></h3>
Please see Winford Engineering's 
<a href="http://www.winfordeng.com/support/download.php">Download Page</a> 
for the latest version of PortIO32.

<a name="samples">
<h3><u>Sample Code:</u></h3>
The following samples are included with the PortIO32 download and demonstrate
the use of the PortIO32 driver and library.
<ul>
 <li><b>Counter program for CRD155B</b><BR>
    This small sample program assumes you have a pushbutton connected to
    an input pin on your I/O card.  Every time the program detects that 
    the pushbutton has been pressed, the program increments a counter value
    and writes it to an output port.  This example includes C source code 
    for both Windows and Linux systems, and Visual Basic 5 code for Windows.
 <li><b>Generic SimpleIO Program</b><br>
    Demonstrates simple, generic port I/O operations that are not specific
    to any particular card.  This is a Visual Basic 5 example.</li>
</ul>

<hr>
<center>
<p>Copyright 2004 Winford Engineering.</center>

</body>
</html>
